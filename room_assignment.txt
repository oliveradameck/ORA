reset;

option omit_zero_rows 1;
option randseed'';
option solver './cplex';

# Room assignment problem
#

# time slots per day
param TpD := 4; 

# days per week
param DpW := 4;


set rooms := {1..2};
set courses := {1..4};
set timeslots := {0..TpD * DpW};
set departments := {1..3};

# Raumkapazitaet
var capacity{r in rooms} integer;
fix capacity[1] := 20;
fix capacity[2] := 50;
#fix capacity[3] := 40;
#param capacity{r in rooms} integer; # := round(Uniform(30,60));

# Kursbelegung
param enrollment{c in courses} := round(Uniform(5,40));

# Anzahl Haeufigkeit eines Kurses pro Woche
param courseFrequency{c in courses} := round(Uniform(1,2));

# Lehrstuhlzuteilung
param departmentAssign{c in courses} := round(Uniform(0.5,3.5));

var x {c in courses, r in rooms, t in timeslots} binary;

# Keine Doppelbelegung Raum, Slots
subject to NB1{r in rooms, t in timeslots}:
    sum{c in courses} x[c,r,t] <= 1;

# Hauufigkeit eines Kurses pro Woche
subject to NB2{c in courses}:
    sum{r in rooms, t in timeslots} x[c,r,t] = courseFrequency[c];

# Raumkapazitaet beachten
subject to NB3{c in courses, r in rooms, t in timeslots}:
    x[c,r,t] * enrollment[c] <= x[c,r,t] * capacity[r];

# Kurse nicht gleichzeitig in verschiedenen Raeumen
subject to NB5{c in courses, t in timeslots}:
    sum{r in rooms} x[c,r,t] <= 1;

# Kurse eines Lehrstuhls nicht gleichzeitig
#subject to NB4{c in courses, t in timeslots, d in departments}:
#    sum{r in rooms} x[c,r,t] <= 


# Lehrveranstaltung nicht am gleichen Tag
subject to NB6{ d in 0..DpW-1, c in courses }:
    sum { r in rooms, t in 0..TpD } x[c,r,d*TpD+t] <= 1;

# Time slot auslastung

# maximize LP: sum{t in timeslots} (100*x[c,r,t]+10*x[i,2]+1*x[i,3]-1000*x[i,4]); # objective

solve;


# auslastung der timeslots
#var auslastung{t in timeslots} := sum{c in courses, r in rooms} x[c, r, t]; 

display x; display capacity; display enrollment; display departmentAssign; display courseFrequency;

end;
